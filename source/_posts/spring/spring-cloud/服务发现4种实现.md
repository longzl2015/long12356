---

title: 服务发现实现

date: 2019-03-20 19:30:00

categories: [spring,springcloud]

tags: [spring,springcloud]

---


spring cloud的服务发现有4种实现方式: Consul、zookeeper、etcd、euerka。


<!--more-->

特性对比表:

|Feature          |Consul             |zookeeper           |etcd               |euerka  |
|----             |---               |---                |---              |  ---|
|服务健康检查       |服务状态，内存，硬盘等|(弱)长连接，keepalive|连接心跳           |可配支持 |
|多数据中心         |支持               |—                   |—                |—       |
|kv存储服务         |支持               |支持                 |支持               |—|
|一致性            |raft             |paxos                |raft                |—|
|cap              |ca                |cp                    |cp                |ap|
|使用接口(多语言能力)|支持http和dns      |客户端                |http/grpc          |http（sidecar）|
|watch支持        |全量/支持long polling|支持                 |支持 long polling   |支持 long polling/大部分增量|
|自身监控          |metrics            |—                   |metrics              |metrics|
|安全             |acl /https          |acl                |https支持（弱）         |—          |
|spring cloud集成 |已支持             |已支持               |  已支持              |已支持|



CAP 选择:

- 一致性（C）：在分布式系统中的所有数据备份，在同一时刻是否同样的值。（所有节点在同一时间的数据完全一致，越多节点，数据同步越耗时）
- 可用性（A）：负载过大后，集群整体是否还能响应客户端的读写请求。（服务一直可用，而且是正常响应时间）
- 分区容错性（P）：分区容忍性，就是高可用性，一个节点崩了，并不影响其它的节点（100个节点，挂了几个，不影响服务，越多机器越好）



## 扩展阅读

[Spring cloud(2)-服务发现(Eureka，Consul)](https://juejin.im/post/5bd037ffe51d45404c71e0b9)
[Eureka vs consul](https://www.zhihu.com/question/55749122)
